# 开发全生命周期 Prompt 索引（可检索 Cheat Sheet）

> 目标：把软件开发 / 代码管理常见场景的 prompt 写成“可搜索的索引”。
> 用法：在 Cursor / Claude Code 里直接复制一条，按需填变量（`<...>`）。

---

## 0. 统一模板（强烈建议先用它包住任何任务）

### 0.1 任务卡（Task Card）
关键词：任务卡 / 目标 / 验收 / 约束 / task-card

```text
你是资深工程师 + 编码代理。

目标（What）：<一句话说明要做什么>
验收（Success）：<可验证的结果，最好可复现>
约束（Constraints）：
- 必须：<例如：不改公共接口/不引入新依赖/保持向后兼容>
- 禁止：<例如：不要臆测；不要改无关文件；不要删除功能>
上下文（Context）：
- 相关目录/文件：<用 @ 指定>
- 现状说明：<当前痛点>

交付（Deliverables）：
- 修改哪些文件（清单）
- 关键 diff 说明
- 如何验证（命令/步骤）

开始前：先给我一个 plan（步骤 + 风险 + 你需要我确认的点），我确认后再动手。
```

### 0.2 反幻觉铁律（必须引用证据）
关键词：反幻觉 / evidence / 引用 / verify

```text
回答任何结论时：
- 必须引用仓库内证据（文件路径 + 关键片段），或明确说明“我没看到证据”。
- 不允许猜测 API、配置、端口、依赖版本。
- 需要运行命令才能确定的，一律先提出要运行什么命令。
```

---

## 1. Onboarding（接手代码 / 屎山读图）

### 1.1 代码库地图（入口、数据流、关键模块）
关键词：repo-map / 入口 / dataflow / 依赖图 / 代码库地图

```text
请快速生成“代码库地图”（1-2 页以内）：
1) 这个项目做什么？核心用户路径是什么？
2) 入口在哪：启动入口 / API 入口 / CLI 入口
3) 关键模块：每个模块的职责 + 依赖方向
4) 数据流：从请求 -> 业务 -> 存储 -> 返回 的主链路
5) 风险点：最可能出 bug/最难改的 3 个点

输出格式：
- Overview
- EntryPoints
- Modules
- DataFlow(ASCII)
- Risks

不要泛泛而谈，必须引用文件路径作为证据。
```

### 1.2 论文 X 光机（深度解构学术/技术文档）
关键词：paper-x-ray / 论文解构 / 学术分析 / delta-extraction

```text
目标：解构该论文/长文档的底层逻辑，而非总结。
请锁定其核心贡献（Delta），寻找逻辑漏洞。

输出框架：
1. 【核心痛点】：一句话定义它想解决什么，前人卡在哪？
2. 【解题机制】：核心直觉（灵光一闪）是什么？关键的神来之笔是什么？
3. 【创新增量】：相比 SOTA 增加了哪块“新拼图”？
4. 【批判性边界】：作者的隐形假设是什么？什么条件下会失败？
5. 【一言以蔽之】：餐巾纸图 + 核心公式。
```

### 1.3 The One（第一性原理本质提取）
关键词：the-one / 本质提取 / 第一性原理 / essence-architect

```text
目标：透过表象看到本质，将复杂系统压缩为极简公式。

步骤：
1. 【解构】：识别核心矛盾与动力机制。
2. 【升维】：发现其对应的“高维模型”。
3. 【形式化】：提炼出「The One」公式。
4. 【迁移】：将此公式应用到一个完全不相关的领域。

输出：ASCII 风格的“本质卡片”。
```

### 1.4 找“真实 SSOT”（配置/常量/规则到底在哪）
关键词：SSOT / source-of-truth / 配置 / 常量 / 规则

```text
请找出以下内容的 SSOT（单一事实源）：
- <例如：鉴权规则/价格计算/环境变量/Feature Flag>

要求：
- 给出唯一权威位置（文件路径）
- 列出所有“疑似重复实现”的位置（文件路径清单）
- 说明是否需要合并/去重，以及风险
```

### 1.3 物理导轨审计（目录拓扑是否合规）
关键词：physical-rails / 目录拓扑 / 架构违章 / rails-audit

```text
请按“物理导轨（Physical Rails）”对该仓库做一次审计：
- 目录拓扑是否清晰？
- 哪些文件放错了位置（列出路径 + 建议迁移到哪里）
- 是否存在“随手堆代码”的垃圾桶目录

输出：
- Findings（问题清单）
- ProposedMoves（迁移建议表：from -> to）
- Risks（迁移风险与回滚）
```

---

## 2. 需求拆解（Spec-driven / 先提案后施工）

### 2.1 Proposal（提案：做什么、怎么做、影响面）
关键词：proposal / 方案 / 影响面 / plan-mode

```text
请先输出 Proposal，不要改代码：
- 目标与非目标
- 方案 A/B（如有）及取舍
- 影响面：会改哪些文件/模块
- 风险点与验证方式
- 任务拆分（tasks checklist）

我确认 Proposal 后你再进入 Apply 阶段。
```

### 2.2 Tasks（最小可交付拆分）
关键词：tasks / checklist / MVP

```text
把这个需求拆成 5-12 个可执行 tasks：
- 每个 task 要能独立验收
- 标注风险等级（low/med/high）
- 标注是否需要迁移/测试/文档

输出为 checklist。
```

---

## 3. 实现（写功能/改代码）

### 3.1 定点修改（最小 diff，避免“顺手重构”）
关键词：minimal-diff / 只改需要的 / scoped-change

```text
请在不改变公共行为的前提下完成需求。
约束：
- 只允许改与该需求直接相关的文件
- 不要做“顺手优化/顺手重构”
- 每次改动都要说明：为什么改、影响什么

开始前：列出你打算修改的文件清单。
```

### 3.2 幂等安全墙（把不确定性关在墙外）
关键词：idempotency / 幂等 / safety-wall / skill-first

```text
请用“幂等安全墙”设计来实现：
- 把可幂等、可确定执行的逻辑抽成脚本/函数/工具（可单测、可复跑）
- 把非幂等、靠模型决策的部分限制在最小范围

交付：
- 墙内（确定逻辑）是什么？入口在哪？如何测试？
- 墙外（模型/策略）是什么？如何降风险？
- 如果失败/超时/重试：如何保证不会重复写入或重复发消息
```

### 3.3 UI 像素级还原（Pixel-Perfect）
关键词：像素级还原 / pixel-perfect / UI / Tailwind

```text
请参考我提供的截图/设计描述，做“像素级还原（Pixel-Perfect）”：
- 严格对齐：间距、字号、行高、圆角、阴影层级、颜色
- 优先用 Tailwind 原子类（必要时扩展主题）
- 组件需可复用、可响应式

输出：
- 组件代码
- 与参考图的对齐说明（哪些点做到了，哪些点需要我给更多信息）
- 如果无法确定（例如字号/字体/颜色值），请列出你需要我补充的最小信息清单
```

### 3.4 物理导轨 + 逻辑契约“双约束”实现
关键词：physical-rails / logical-contracts / 契约 / rails

```text
请在实现该需求时同时满足：
- 物理导轨：文件必须放在正确目录，禁止把业务逻辑塞进 utils/helpers
- 逻辑契约：输入/输出 schema 明确；错误码/异常路径一致

开始前：列出你打算创建/修改/移动的文件清单。
结束后：给出契约变化与回归验证步骤。
```

### 3.5 设计增强（使用 ui-ux-pro-max 插件）
关键词：ui-ux-pro-max / 设计灵魂 / 审美 / 动效

```text
请配合 `ui-ux-pro-max` 规则集来生成该界面：
- 风格选择：<Cyberpunk/Minimalist/Glassmorphism/SaaS 等>
- 交互重点：<按钮反馈/加载骨架屏/入场动画/响应式对齐>
- 约束：严格遵循该插件注入的设计规范，拒绝通用 AI 样式。

交付：
- 核心代码（Tailwind + Framer Motion/GSAP）
- 关键设计决策说明（为什么选这个颜色/间距）
```

---

## 4. 重构（Re-Vibe / 清技术债）

### 4.1 先写重构边界（不允许“越界重构”）
关键词：refactor-boundary / scope / 不越界

```text
请先定义重构边界：
- 目标：要解决的具体问题（可量化）
- 非目标：明确哪些不碰
- 外部接口是否保持不变
- 回滚策略

我确认后再动手。
```

### 4.2 迁移文件（物理导轨对齐）
关键词：move-files / 目录调整 / physical-rails

```text
请把以下文件迁移到符合“物理导轨”的位置：
- <列出路径>

要求：
- 保持 import 引用正确
- 每次迁移后给出影响面（引用处）
- 提供验证命令/步骤
```

---

## 5. Debug（排障/定位问题）

### 5.1 复现驱动 Debug（先复现再修）
关键词：repro / debug / 最小复现

```text
请按以下顺序帮我 Debug：
1) 复现：写出最小复现步骤（或最小脚本）
2) 观察：需要哪些日志/指标/快照
3) 假设：列出 3-5 个可能原因（按概率排序）
4) 验证：每个假设用什么实验排除
5) 修复：最小 diff 修复
6) 回归：加测试或加监控防止复发

不要直接给结论，必须先给复现与验证方案。
```

### 5.2 Git 冲突与回滚
关键词：git-conflict / revert / rollback

```text
我现在遇到 git 冲突/需要回滚：
- 分支：<...>
- 冲突文件：<...>

请给我：
- 最安全的解决路径（含命令）
- 如果解决错了，如何回滚到安全点
- 如何避免再次冲突（策略建议）
```

### 5.3 深度进程诊断（使用 witr 工具）
关键词：witr / 进程溯源 / 端口占用 / 因果链

```text
我遇到一个进程/端口问题，请使用 `witr` 帮我诊断：
1) 运行 `witr <PID/Port/Service>` 获取因果链。
2) 分析该进程的父子关系、启动命令和运行背景。
3) 判断该进程是否为异常驻留、恶意进程或配置错误。
4) 给出清理或修复建议。

不要只杀进程，要找出它为什么在那。
```

---

## 6. Testing（补测试/防回归）

### 6.1 先写测试策略，再写测试代码
关键词：test-strategy / coverage / regression

```text
请先给测试策略：
- 哪些是单测/集成测/E2E
- 哪些是关键边界条件
- 哪些失败路径必须覆盖

我确认策略后，你再开始写测试。
```

### 6.2 黄金样例（Golden Tests）
关键词：golden-test / snapshot / regression

```text
为以下输出建立 golden tests：
- 输入样例：<列出>
- 预期输出：<列出或生成>

要求：
- 输出可读、可 diff
- 当行为变更时，必须显式更新 golden
```

---

## 7. Security / Performance（安全与性能）

### 7.1 威胁建模（Threat Model）
关键词：threat-model / attack-surface / auth

```text
请对 <模块/接口> 做威胁建模：
- 资产（要保护什么）
- 攻击面（入口）
- 主要威胁（按 STRIDE 或自定义）
- 缓解措施（落到代码/配置）

输出必须可执行（不是科普）。
```

### 7.2 性能剖析（Profile-first）
关键词：performance / profiling / bottleneck

```text
请按“先测量后优化”来做性能优化：
- 你需要我提供哪些指标/日志/样本数据
- 你会如何定位瓶颈（方法与命令）
- 给出 1-3 个最优先的优化点（含预期收益）
```

---

## 8. Git / 协作 / 交付（代码管理）

### 8.1 PR 描述生成器（可审可追溯）
关键词：pr-template / review / changelog

```text
请根据这次改动生成 PR 描述：
- 背景
- 改动点（按文件/模块分组）
- 风险与回滚
- 验证步骤
- 截图/证据（如有）

要求：不夸张，不营销，面向 code review。
```

### 8.2 Commit Message（小步提交）
关键词：commit-message / conventional-commits

```text
请为以下改动生成 3 个候选 commit message（conventional commits 风格）：
- 改动摘要：<...>
- 影响面：<...>

并说明每个候选更适合什么语境。
```

---

## 9. 文档与治理（Blog -> Docs 提纯）

### 9.1 从 Blog 提纯成 Docs（方法论沉淀）
关键词：distill / blog-to-docs / methodology

```text
请把这段动态内容提纯成 docs 方法论文档：
- 抽象出可复用原则（3-7 条）
- 给出反例与失败模式
- 给出最小可执行 checklist
- 给出可复制的 prompt 模板

输出落点建议：放到 docs/<分类>/...
```

---

## 10. 你可以把它当“提示词菜单”

当你不确定该用哪条时，先说一句：

```text
我现在要做的是：<Onboarding/需求拆解/实现/重构/Debug/测试/交付>
请从《开发全生命周期 Prompt 索引》中帮我选 1-3 条最合适的 prompt，并替我把变量填好。
```
